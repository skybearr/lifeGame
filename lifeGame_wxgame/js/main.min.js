var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))(function(i,o){function r(t){try{h(a.next(t))}catch(e){o(e)}}function s(t){try{h(a["throw"](t))}catch(e){o(e)}}function h(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(r,s)}h((a=a.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return a([t,e])}}function a(n){if(i)throw new TypeError("Generator is already executing.");for(;h;)try{if(i=1,o&&(r=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,o=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){h.label=n[1];break}if(6===n[0]&&h.label<r[1]){h.label=r[1],r=n;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(n);break}r[2]&&h.ops.pop(),h.trys.pop();continue}n=e.call(t,h)}catch(a){n=[6,a],o=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,r,s,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},msgGoodsBuyRsp=function(){function t(){this.goods=[]}return t}();__reflect(msgGoodsBuyRsp.prototype,"msgGoodsBuyRsp");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function a(a){e.call(n,a,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?a(i):RES.getResAsync(t,a,this)}else RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),GameLogic.getInstance().GameStage=this.stage,WxApi.getInstance().GameStage=this.stage,GameLogic.getInstance().main=this,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return e.sent(),[4,this.loadTheme()];case 2:return e.sent(),[4,RES.loadGroup("preload",0,this.loadingView)];case 3:return e.sent(),null!=this.loadingView&&null!=this.loadingView.parent&&this.loadingView.parent.removeChild(this.loadingView),[3,5];case 4:return t=e.sent(),console.error(t),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var a=new eui.Theme("resource/default.thm.json",t.stage);a.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){null!=this.loadingView&&null!=this.loadingView.parent&&this.loadingView.parent.removeChild(this.loadingView),this.loadingView=null,GameLogic.getInstance().init()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,a){function i(t){e.call(a,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(a))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(a,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GameCommand=function(t){function e(){var e=t.call(this)||this;return e.bases=[],e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.sendData=function(t){void 0===t&&(t=!1),t&&(DataBase.debt=Formula.getDebt(DataBase.debt),DataBase.deposit=Formula.getDeposit(DataBase.deposit));var e=this.getData();GameLogic.getInstance().gameui.initData(e)},e.prototype.sendMarket=function(t){DataBase.events=[],DataBase.marketGoods=[];var e=this.getMarket(t);DataBase.marketGoods=e.goods,GameLogic.getInstance().gameui.initMarket(e)},e.prototype.sendStore=function(){var t=new msgGoodsStoreRsp;t.goods=DataBase.storeGoods,GameLogic.getInstance().gameui.initStore(t)},e.prototype.sendEvent=function(){this.dealOtherEvent();for(var t=DataBase.events,e=0;e<t.length;e++)GameLogic.getInstance().gameui.eventAppear(t[e]);DataBase.events=[]},e.prototype.sendError=function(t){egret.setTimeout(function(){GameLogic.getInstance().gameui.errorRsp(t)},this,100)},e.prototype.sendOver=function(t){DataBase.gameState=0,0==t&&(DataBase.debt=Formula.getDebt(DataBase.debt),DataBase.deposit=Formula.getDeposit(DataBase.deposit),DataBase.money=DataBase.money+DataBase.deposit-DataBase.debt+this.getStorePrice(),DataBase.debt=0,DataBase.deposit=0),this.sendData(),GameLogic.getInstance().gameui.over(),0==t&&WxApi.getInstance().setHigherScore(DataBase.money)},e.prototype.getStorePrice=function(){for(var t=0,e=0;e<DataBase.storeGoods.length;e++){var n=DataBase.storeGoods[e];t+=n.dwPrice*n.dwNum}return t},e.prototype.getData=function(){var t=new msgLifeDataRsp;return t.dwMoney=DataBase.money,t.dwDebt=DataBase.debt,t.dwDeposit=DataBase.deposit,t.dwPow=DataBase.pow,t.dwTimes=DataBase.times,t.dwMaxStoreNum=DataBase.maxStoreNum,t.dwFame=DataBase.fame,t},e.prototype.getMarket=function(t){var e=new msgGoodsBuyRsp;e.goods=[];var n=this.bases.length,a=4+Math.floor(Math.random()*(n-3)),i=this.bases.slice();1==DataBase.gamePackage?i.length-1:i.length;i=StringUtil.shuffle(i);for(var o=[],r=0;a>r;r++)o.push(i[r]);o.sort(this.sortfun);for(var r=0;r<o.length;r++){var s=new varGoods,h=o[r],c=GameLogic.getInstance().goods[h];null!=c&&(s.dwID=h,s.strName=c.name,s.dwPrice=this.getPrice(c,t),s.dwNum=0,e.goods.push(s))}return e},e.prototype.dealOtherEvent=function(){var t=Formula.getOtherEvent();null!=t&&this.addEvent(t.a,t.b,t.c)},e.prototype.addEvent=function(t,e,n){var a=100*t+10*e+n,i=GameLogic.getInstance().goods["evt"+a];if(null!=i){var o=2==e,r=i.value;if(5>t)switch(t){case 1:r=1>=r?Math.floor(DataBase.money*r):Math.floor(Math.random()*r/5),DataBase.money=DataBase.money+(o?r:-r),DataBase.money=DataBase.money<=0?0:DataBase.money;break;case 2:r=1>=r?Math.floor(DataBase.money*r):Math.floor(Math.random()*r/5),DataBase.deposit=DataBase.deposit+(o?r:-r),DataBase.deposit=DataBase.deposit<=0?0:DataBase.deposit;break;case 3:DataBase.pow=DataBase.pow+(o?r:-r),DataBase.pow=DataBase.pow<=0?0:DataBase.pow;break;case 4:DataBase.saveFame(DataBase.fame+(o?r:-r)),DataBase.saveFame(DataBase.fame<=0?0:DataBase.fame)}"string"==typeof i?DataBase.events.push(StringUtil.getSwfLangStr(i)):DataBase.events.push(StringUtil.getSwfLangStrVar(i.str,[r]))}},e.prototype.getPrice=function(t,e){var n=t.price,a=Formula.getRandom1(),i=Math.floor(n*a),o=Formula.isAdd(),r=Math.floor(i*Formula.getRandom2());if(i=o?i+r:i-r,e){var s=Formula.apperEvent();if(s){var h=Formula.getRandom3();i=Math.floor(i*h);var c=Math.floor(3*Math.random())+1,l="evt"+(1>h?0:1)+c;DataBase.events.push(t[l])}}return 0>=i&&(i=1),i},e.prototype.sortfun=function(t,e){return e>t?-1:1},e.prototype.saveAchieve=function(){DataBase.money>DataBase.achives[0]&&(DataBase.achives[0]=DataBase.money),DataBase.deposit>DataBase.achives[1]&&(DataBase.achives[1]=DataBase.deposit),DataBase.debt>DataBase.achives[2]&&(DataBase.achives[2]=DataBase.debt),DataBase.pow<DataBase.achives[3]&&(DataBase.achives[3]=DataBase.pow),DataBase.fame<DataBase.achives[4]&&(DataBase.achives[4]=DataBase.fame),DataBase.fame>DataBase.achives[5]&&(DataBase.achives[5]=DataBase.fame)},e.prototype.getPriceInMarket=function(t){for(var e=DataBase.marketGoods,n=0;n<e.length;n++){var a=e[n];if(t==a.dwID)return a.dwPrice}return null},e.prototype.selectPackage=function(t){DataBase.gamePackage=t},e.prototype.startGame=function(){var t=GameLogic.getInstance().data["config"+DataBase.gamePackage];DataBase.times=1,DataBase.money=t.money,DataBase.debt=t.debt,DataBase.deposit=0,DataBase.pow=t.pow,DataBase.maxStoreNum=100;var e=WxApi.getInstance().getLocalData("fame");DataBase.fame=null==e?t.fame:parseInt(e),DataBase.marketGoods=[],DataBase.storeGoods=[],DataBase.events=[],DataBase.achives=[0,0,0,0,0],DataBase.gameState=1,this.sendData(),this.sendMarket(!1)},e.prototype.passOneDay=function(){return 0!=DataBase.gameState?(DataBase.times++,DataBase.times>=GameLogic.getInstance().data.maxday?void this.sendOver(0):(this.sendMarket(!0),this.sendEvent(),this.sendData(!0),DataBase.pow<=0?void this.sendOver(1):void this.saveAchieve())):void 0},e.prototype.buyGoods=function(t,e){if(0==e)return void this.sendError(ERROR.BUY_ZERO);if(t==this.bases[this.bases.length-1]&&1==DataBase.gamePackage)return void this.sendError(ERROR.NEED_LICIENCE);for(var n=DataBase.marketGoods,a=0;a<n.length;a++){var i=n[a];if(i.dwID==t){var o=i.dwPrice*e;if(o>DataBase.money)return void this.sendError(ERROR.MONEY_NOT_ENOUGH);for(var r=DataBase.storeGoods,s=0,h=void 0,c=0;c<r.length;c++){var l=r[c];l.dwID==t&&(h=c),s+=l.dwNum}if(s+e>DataBase.maxStoreNum)return void this.sendError(ERROR.STORE_NOT_ENOUGH);DataBase.money-=o;var u=r[h];if(null==u)u=new varGoods,u.dwID=t,u.dwPrice=i.dwPrice,u.dwNum=e,u.strName=i.strName,r.push(u);else{var p=u.dwNum+e,g=Math.floor((u.dwPrice*u.dwNum+i.dwPrice*e)/p);u.dwNum=p,u.dwPrice=g,r[h]=u}this.sendData(),this.sendStore();break}}},e.prototype.sellGoods=function(t,e){if(0==e)return void this.sendError(ERROR.SELL_ZERO);var n=this.getPriceInMarket(t);if(null==n)return void this.sendError(ERROR.MARKET_NO_GOOD);for(var a=DataBase.storeGoods,i=0;i<a.length;i++){var o=a[i];if(o.dwID==t){DataBase.money+=n*e,o.dwNum-=e,o.dwNum<=0&&DataBase.storeGoods.splice(i,1),this.sendData(),this.sendStore();break}}},e.prototype.cun=function(t){t>0&&t<=DataBase.money&&(DataBase.deposit+=t,DataBase.money-=t,this.sendData())},e.prototype.qu=function(t){t>0&&t<=DataBase.deposit&&(DataBase.deposit-=t,DataBase.money+=t,this.sendData())},e.prototype.huan=function(t){t>0&&t<=DataBase.money&&t<=DataBase.debt&&(DataBase.debt-=t,DataBase.money-=t,this.sendData())},e.prototype.treat=function(t){if(t>0&&100>t){t+DataBase.pow>100&&(t=100-DataBase.pow);var e=t*GameLogic.getInstance().data.hospital;if(e>=DataBase.money)return void this.sendError(ERROR.MONEY_NOT_ENOUGH);DataBase.money-=e,DataBase.pow+=t,this.sendData()}},e.prototype.charity=function(t){if(t>DataBase.money)return void this.sendError(ERROR.MONEY_NOT_ENOUGH);var e,n=GameLogic.getInstance().data.charity;if(n>t){var a=100*Math.random();2>a?(DataBase.saveFame(DataBase.fame+3),e=0):e=1}else{var i=Math.floor(t/n);DataBase.saveFame(DataBase.fame+i),e=10>i?2:100>i?3:4}this.addEvent(5,1,e),DataBase.money-=t,this.sendData(),this.sendEvent()},e.prototype.buyStore=function(t){var e=GameLogic.getInstance().data.maxstore;if(DataBase.maxStoreNum>=e)return void this.sendError(ERROR.MAX_STORE_NUM);var n=GameLogic.getInstance().data.storeprice;if(n>t)return void console.log("价格低于标准值，请勿作弊");if(DataBase.money<t)return void this.sendError(ERROR.MONEY_NOT_ENOUGH);DataBase.maxStoreNum+=10,DataBase.maxStoreNum>=e&&(DataBase.maxStoreNum=e);var a=Math.floor(Math.random()*n/5);DataBase.money-=t+a,this.sendData(),this.addEvent(5,0,0),this.sendEvent()},e}(egret.EventDispatcher);__reflect(GameCommand.prototype,"GameCommand");var GameEvent=function(t){function e(e,n,a){void 0===n&&(n=!1),void 0===a&&(a=!1);var i=t.call(this,e,n,a)||this;return i.data=null,i}return __extends(e,t),e.REWARDAD_CLOSE_EVENT="REWARDAD_CLOSE_EVENT",e.PROP_NUM_CHANGE="PROP_NUM_CHANGE",e}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var GameLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SoundManager.getInstance().playBgSound(!0),this.initData(),this.getHiscore(),this.openStart(),WxApi.getInstance().initShareInfo()},e.prototype.openStart=function(){this.main.removeChildren(),this.main.addChild(new StartUI)},e.prototype.getHiscore=function(){var t=WxApi.getInstance().getLocalData(PlayerConst.hiscore);PlayerConst.highestScore=null==t?0:t},e.prototype.initData=function(){if(null==this.data&&(this.data=RES.getRes("config_json")),null==this.strings&&(this.strings=RES.getRes("strings_json")),null==this.goods){this.goods=RES.getRes("goods_json");for(var t=1;;){if(null==this.goods[t])break;GameCommand.getInstance().bases.push(t),t++}}},e.prototype.startGame=function(){this.main.removeChildren(),this.main.addChild(new GameUI)},e.prototype.login=function(){var t=window.wx;null!=t&&t.login({success:function(){t.getUserInfo({fail:function(t){t.errMsg.indexOf("auth deny")>-1||t.errMsg.indexOf("auth denied")>-1}})}})},e.prototype.showShareMenu=function(){var t=window.wx;null!=t&&(t.showShareMenu(),this.onShare("rightup=1"))},e.prototype.share=function(t){void 0===t&&(t=null);var e=window.wx;null!=e&&(this.updateShareMenu(!0),e.shareAppMessage({title:"来苏州一起浮生吧啊啊啊啊啊啊啊啊啊啊啊啊",imageUrl:"resource/assets/img/qua_1.png",query:t}))},e.prototype.onShare=function(t){void 0===t&&(t="rightup=1");var e=window.wx;null!=e&&(this.updateShareMenu(!0),console.log("onShare:query:",t),e.onShareAppMessage(function(){return{title:"右上角转发一起来苏州浮生吧",imageUrl:"resource/assets/img/qua_4.png",query:t}}))},e.prototype.updateShareMenu=function(t){var e=window.wx;null!=e&&(console.log("updateShareMenu:",t),e.updateShareMenu({withShareTicket:t,success:function(t){console.log("updateShareMenu:success:",t)},fail:function(t){console.log("updateShareMenu:fail:",t)},complete:function(){console.log("updateShareMenu:complete:")}}))},e.prototype.openRank=function(t){void 0===t&&(t=null),this.main.addChild(new RankUI(t))},e.prototype.openFriendRank=function(t,e){void 0===e&&(e=""),this.isFriend=t,null==this.rankingListMask&&(this.rankingListMask=new egret.Shape,this.rankingListMask.graphics.beginFill(0,1),this.rankingListMask.graphics.drawRect(0,0,this.GameStage.width,this.GameStage.height),this.rankingListMask.graphics.endFill(),this.rankingListMask.alpha=.8,this.rankingListMask.touchEnabled=!0),this.main.addChild(this.rankingListMask);var n=new egret.BitmapData(window.sharedCanvas);n.$deleteSource=!1;var a=new egret.Texture;a._setBitmapData(n),this.bitmap=new egret.Bitmap(a),this.bitmap.width=this.GameStage.stageWidth,this.bitmap.height=this.GameStage.stageHeight,this.main.addChild(this.bitmap),null==this.btn_rankclose&&(this.btn_rankclose=new eui.Image,this.btn_rankclose.source=RES.getRes("qua_0_png"),this.btn_rankclose.left=20,this.btn_rankclose.bottom=40,this.btn_rankclose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeFriendRank,this)),this.main.addChild(this.btn_rankclose),null==this.btn_grouprank&&(this.btn_grouprank=new eui.Image,this.btn_grouprank.source=RES.getRes(t?"qua_0_png":"qua_1_png"),this.btn_grouprank.right=20,this.btn_grouprank.bottom=40,this.btn_grouprank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openGroupRank,this)),this.main.addChild(this.btn_grouprank),egret.startTick(function(t){return egret.WebGLUtils.deleteWebGLTexture(n.webGLTexture),n.webGLTexture=null,!1},this),console.log("postMessage:",this.userInfo),wx.getOpenDataContext().postMessage({head:t?"friend":"group",userinfo:this.userInfo,shareTicket:e,open:!0})},e.prototype.closeFriendRank=function(){this.bitmap&&this.bitmap.parent&&this.bitmap.parent.removeChild(this.bitmap),this.btn_rankclose&&this.btn_rankclose.parent&&this.btn_rankclose.parent.removeChild(this.btn_rankclose),this.btn_grouprank&&this.btn_grouprank.parent&&this.btn_grouprank.parent.removeChild(this.btn_grouprank),this.rankingListMask&&this.rankingListMask.parent&&this.rankingListMask.parent.removeChild(this.rankingListMask),wx.getOpenDataContext().postMessage({head:"friend",open:!1})},e.prototype.openGroupRank=function(){this.isFriend?this.share("grouprank=1"):this.closeGroupRank()},e.prototype.closeGroupRank=function(){this.closeFriendRank()},e.prototype.setUserCloudStorage=function(){var t=window.wx;if(null!=t){for(var e="",n=0;n<DataBase.achives.length;n++)e+=DataBase.achives[n],n<DataBase.achives.length&&(e+=",");t.setUserCloudStorage({KVDataList:[{key:"score",value:DataBase.money+""},{key:"fame",value:DataBase.fame+""},{key:"achives",value:e}],success:function(t){console.log("setUserCloudStorage:res:",t)},fail:function(t){console.log("setUserCloudStorage:error:",t)},complete:function(){console.log("setUserCloudStorage:complete:")}})}},e.prototype.removeUserCloudStorage=function(t){wx.removeUserCloudStorage()({keyList:t,success:function(t){console.log("removeUserCloudStorage:res:",t)},fail:function(t){console.log("removeUserCloudStorage:error:",t)},complete:function(){console.log("removeUserCloudStorage:complete:")}})},e.prototype.setUserStorage=function(t){},e}(egret.EventDispatcher);__reflect(GameLogic.prototype,"GameLogic");var SoundManager=function(){function t(){this.bg_position=0,this.sound_switch=!1,this.sound_effect_switch=!1}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.playBgSound=function(t){this.sound_switch=t,t?(null==this.bgSound&&(this.bgSound=RES.getRes("bg_mp3")),null!=this.bgChannel&&(this.bgChannel.stop(),this.bgChannel=null),this.bgChannel=this.bgSound.play(this.bg_position,0)):null!=this.bgChannel?(this.bg_position=this.bgChannel.position,this.bgChannel.stop(),this.bgChannel=null):this.bg_position=0},t.prototype.setSoundEffectSwitch=function(t){this.sound_effect_switch=t},t.prototype.playEffectSound=function(t){if(void 0===t&&(t="sound_11_wav"),this.sound_effect_switch){var e=RES.getRes(t);if(null!=e){var n=e.play(0,1),a={s:e,c:n},i=function(){this.c.stop(),this.c=null,this.s=null};n.addEventListener(egret.Event.SOUND_COMPLETE,i,a)}}},t}();__reflect(SoundManager.prototype,"SoundManager");var DataBase=function(){function t(){}return t.saveFame=function(e){t.fame=e},t}();__reflect(DataBase.prototype,"DataBase");var GameConst=function(){function t(){}return t.web=1,t.version="201808181130",t}();__reflect(GameConst.prototype,"GameConst");var ERROR;!function(t){t[t.MONEY_NOT_ENOUGH=1]="MONEY_NOT_ENOUGH",t[t.STORE_NOT_ENOUGH=2]="STORE_NOT_ENOUGH",t[t.BUY_ZERO=3]="BUY_ZERO",t[t.SELL_ZERO=4]="SELL_ZERO",t[t.MARKET_NO_GOOD=5]="MARKET_NO_GOOD",t[t.MAX_STORE_NUM=6]="MAX_STORE_NUM",t[t.NEED_LICIENCE=7]="NEED_LICIENCE"}(ERROR||(ERROR={}));var ACHIVE;!function(t){t[t.RELIVE=1]="RELIVE"}(ACHIVE||(ACHIVE={}));var PlayerConst=function(){function t(){}return t.prop_num=0,t.hiscore="hiscore",t}();__reflect(PlayerConst.prototype,"PlayerConst");var Int64=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._highValue=0,this._lowValue=0,this.cacheString=new Array,this._lowValue=t,this._highValue=e}return Object.defineProperty(t.prototype,"higherUint",{get:function(){return this._highValue},set:function(t){this._highValue!=t&&(this._highValue=t,this.cacheBytes=null,this.cacheString=[])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lowerUint",{get:function(){return this._lowValue},set:function(t){this._lowValue=t,this._lowValue!=t&&(this.cacheBytes=null,this.cacheString=[])},enumerable:!0,configurable:!0}),t.prototype.fromString=function(t,e){if(void 0===e&&(e=10),!t)return void this.reset();t=t.toLowerCase();for(var n=4294967296,a=0,i=0,o=0;o<t.length;o++){var r=t.charCodeAt(o)-48;r>9&&(r-=39),a=a*e+r,i=i*e+(a/n>>0),a%=n}this._lowValue=a,this._highValue=i,this.cacheString=[],this.cacheString[e]=t,this.cacheBytes=null},t.prototype.fromBytes=function(t,e){void 0===e&&(e=0);try{t.position=e,t.endian==egret.Endian.LITTLE_ENDIAN?(this._lowValue=t.readUnsignedInt(),this._highValue=t.readUnsignedInt()):(this._highValue=t.readUnsignedInt(),this._lowValue=t.readUnsignedInt())}catch(n){return void this.reset()}this.cacheBytes=null,this.cacheString=[]},t.prototype.reset=function(){this._highValue=0,this._lowValue=0,this.cacheBytes=null,this.cacheString=[]},t.prototype.clone=function(){return new t(this._lowValue,this._highValue)},t.prototype.copy=function(t){this.reset(),this._lowValue=t._lowValue,this._highValue=t._highValue},t.prototype.cloneTo=function(e){return null==e&&(e=new t),e.copy(this),e},t.prototype.equals=function(t){return null==t?!1:this._highValue==t._highValue&&this._lowValue==t._lowValue},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.cacheBytes?this.cacheBytes:(this.cacheBytes=new egret.ByteArray,this.cacheBytes.endian=egret.Endian.LITTLE_ENDIAN,this.cacheBytes.writeUnsignedInt(this._lowValue),this.cacheBytes.writeUnsignedInt(this._highValue),this.cacheBytes)},enumerable:!0,configurable:!0}),t.prototype.toNumber=function(){var t=this.toString();return""==t?0:parseInt(t)},t.prototype.toString=function(t){if(void 0===t&&(t=10),2>t||t>36)throw new RangeError("基数参数必须介于 2 到 36 之间；当前值为 "+t+"。");if(this.cacheString[t])return this.cacheString[t];for(var e,n,a,i="",o=this._lowValue,r=this._highValue,s=Math.pow(2,32);0!=r||0!=o;)e=r%t,a=e*s+o,n=a%t,i=n.toString(t)+i,r=(r-e)/t,o=(a-n)/t;return this.cacheString[t]=""==i?"0":i,this.cacheString[t]},t.prototype.parseData=function(t){this._highValue=t.readUnsignedInt(),this._lowValue=t.readUnsignedInt()},t.prototype.toData=function(t){t.writeUnsignedInt(this._highValue),t.writeUnsignedInt(this._lowValue)},t.prototype.gc=function(){this.cacheBytes=null,this.cacheString=null},t}();__reflect(Int64.prototype,"Int64");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var msgGoodsStoreRsp=function(){function t(){this.goods=[]}return t}();__reflect(msgGoodsStoreRsp.prototype,"msgGoodsStoreRsp");var msgLifeDataRsp=function(){function t(){this.dwPow=0,this.dwDebt=0,this.dwTimes=0,this.dwMaxStoreNum=0,this.dwFame=0}return t}();__reflect(msgLifeDataRsp.prototype,"msgLifeDataRsp");var varGoods=function(){function t(){this.dwID=0,this.dwPrice=0,this.dwNum=0}return t}();__reflect(varGoods.prototype,"varGoods");var Formula=function(){function t(){}return t.getDebt=function(t){return Math.floor(1.15*t)},t.getDeposit=function(t){return Math.floor(1.04*DataBase.deposit)},t.getOtherEvent=function(){var t,e=Math.random()<.1;if(e){t={};var n=Math.floor(4*Math.random())+1,a=Math.random()<.5?1:2,i=Math.floor(3*Math.random())+1;t.a=n,t.b=a,t.c=i}return t},t.getRandom1=function(){var e=Math.random();if(.1>e){var n=Math.floor(3*Math.random());return t.diss1[n]}return 1},t.isAdd=function(){return Math.random()<.5},t.getRandom2=function(){return.2*Math.random()},t.apperEvent=function(){return Math.random()<.05},t.getRandom3=function(){var e=Math.floor(4*Math.random());return t.diss2[e]},t.diss1=[.3,3,8],t.diss2=[.1,.2,5,10],t}();__reflect(Formula.prototype,"Formula");var StringUtil=function(){function t(){}return t.getSwfLangTextFlowVar=function(e,n){return(new egret.HtmlTextParser).parser(t.getSwfLangStrVar(e,n))},t.getSwfLangStrVarByID=function(e,n){if(null==GameLogic.getInstance().strings)return e;var a=GameLogic.getInstance().strings[e];return null==a?e:t.getSwfLangStrVar(a,n)},t.getSwfLangStrVar=function(e,n){var a,i,o;a=e.indexOf("{"),i=e.indexOf("}");for(var r,s,h,c,l=0;-1!=a&&-1!=i;){o=e.substring(a,i+1),r=e.indexOf("@",l);var u=parseInt(e.substring(r+1,e.indexOf(":",r)))-1;if(0/0==u)return"stringError:"+e;s=e.indexOf("!#[",l)+3,s>2&&(h=e.indexOf("]@",l),c=e.substring(s,h),n[u]=t.getSwfLangStr(c+n[u]));var p=n[u].toString();e=e.replace(o,p),l=a+p.length,a=e.indexOf("{",l),i=e.indexOf("}",l)}return e},t.getSwfLangStr=function(t){if(null==GameLogic.getInstance().strings)return t;var e=GameLogic.getInstance().strings[t];return null==e?t:e.toString()},t.shuffle=function(t){for(var e=t.slice(),n=[];;){var a=Math.floor(Math.random()*e.length);if(n.push(e[a]),e.splice(a,1),0==e.length)break}return n},t}();__reflect(StringUtil.prototype,"StringUtil");var WxApi=function(t){function e(){var e=t.call(this)||this;return e.titlestr=["我来苏州40天就买了3套房，你也试试？","阳澄湖大闸蟹上市了，不想尝尝吗","苏州园林甲江南 江南园林甲天下，苏州欢迎您","迪士尼太远，来苏州乐园，苏州欢迎您","是松鼠桂鱼还是松鼠鳜鱼，点击试吃"],e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){1==GameConst.web?GameLogic.getInstance().init():this.login()},e.prototype.checkWx=function(){var t=window.wx;return null!=t},e.prototype.isNew=function(){var t=this.getLocalData("newhand");return null==t?(this.setLocalDataByString("newhand","notnew"),!0):!1},e.prototype.showToast=function(t){this.checkWx()&&wx.showToast({title:t})},e.prototype.getShareTitle=function(){var t=Math.floor(Math.random()*this.titlestr.length);return this.shareIndex=t,this.titlestr[t]},e.prototype.getShareImage=function(){var t=null!=this.shareIndex?this.shareIndex:0;return"resource/assets/img/share"+t+".jpg"},e.prototype.share=function(t){if(void 0===t&&(t=null),this.checkWx()){this.updateShareMenu(!0);var n=null==t?e.getInstance().shareInfo.query:t;wx.shareAppMessage({title:e.getInstance().getShareTitle(),imageUrl:e.getInstance().getShareTitle(),query:n,success:function(t){DataBase.money+=5e3}})}},e.prototype.initShareInfo=function(t){void 0===t&&(t=null),null==t&&(t={share_game_title:"我来苏州40天就买了3套房，来苏州玩玩？",share_game_img:"resource/assets/img/share.jpg",query:""}),this.shareInfo=t,this.checkWx()&&(console.log("initShareInfo:",t),wx.showShareMenu(),this.onShare(),this.checkShareInfo())},e.prototype.checkShareInfo=function(){if(console.log("checkShareInfo"),this.checkWx()){var t=wx.getLaunchOptionsSync();console.log("info:",t),null!=t&&null!=t.shareTicket&&""!=t.shareTicket&&null!=t.query&&"1"==t.query.grouprank&&wx.getShareInfo({shareTicket:t.shareTicket,success:function(e){console.log("getShareInfo:success:",e),GameLogic.getInstance().openRank(t.shareTicket)},fail:function(t){console.log("getShareInfo:fail:",t)},complete:function(){console.log("getShareInfo:complete:")}})}},e.prototype.onShare=function(t){if(void 0===t&&(t="rightup=1"),this.checkWx()){this.updateShareMenu(!0);var n=null==t?e.getInstance().shareInfo.query:t;console.log("onShareAppMessage:",this.shareInfo),wx.onShareAppMessage(function(){return{title:e.getInstance().shareInfo.getShareTitle(),imageUrl:e.getInstance().shareInfo.share_game_img,query:n}})}},e.prototype.updateShareMenu=function(t){this.checkWx()&&(console.log("updateShareMenu:withShareTicket:",t),wx.updateShareMenu({withShareTicket:t,success:function(t){console.log("updateShareMenu:success:",t)},fail:function(t){console.log("updateShareMenu:fail:",t)},complete:function(){console.log("updateShareMenu:complete:")}}))},e.prototype.setHigherScore=function(t){if(!(0>=t)&&this.checkWx()){var e=PlayerConst.highestScore;if(!(e>=t)){PlayerConst.highestScore=t,this.setLocalDataByString(PlayerConst.hiscore,t+"");wx.setUserCloudStorage({KVDataList:[{key:"score",value:t+""},{key:"date",value:(new Date).getTime().toString()}],success:function(t){console.log("setUserCloudStorage:res:",t)},fail:function(t){console.log("setUserCloudStorage:error:",t)},complete:function(){console.log("setUserCloudStorage:complete:")}})}}},e.prototype.setLocalDataByObject=function(t,e){var n=JSON.stringify(e);this.setLocalDataByString(t,n)},e.prototype.setLocalDataByString=function(t,e){if(!this.checkWx())return null;try{return wx.setStorageSync(t,e)}catch(n){return null}},e.prototype.getLocalData=function(t){if(!this.checkWx())return null;try{return wx.getStorageSync(t)}catch(e){return null}},e.prototype.clearLocalData=function(t){if(!this.checkWx())return null;try{return wx.clearStorageSync(t)}catch(e){return null}},e.prototype.toast=function(t){return this.checkWx()?void wx.showToast({title:t}):null},e.prototype.login=function(){var t=this,e=window.wx;null!=e&&e.login({success:function(e){console.log("wxloginsuccess:",e),t.logincode=e.code,GameLogic.getInstance().init()},fail:function(){},complete:function(){}})},e.prototype.showoff=function(){var t=window.wx;null!=t&&(this.updateShareMenu(!0),t.shareAppMessage({title:PlayerConst.highestScore+"分，不服来战！",imageUrl:e.getInstance().shareInfo.share_group_img,query:e.getInstance().shareInfo.query}))},e.prototype.drawBMP=function(){var t=new egret.DisplayObjectContainer,e=new egret.Bitmap,n=RES.getRes("over_json.game_over_share");e.texture=n,t.addChild(e);var a=new egret.TextField;a.width=200,a.height=24,a.size=24,a.textAlign="center",a.fontFamily="SimHei",a.x=t.width-a.width>>1,a.y=310,t.addChild(a);var i=new egret.TextField;i.text=PlayerConst.highestScore+"分",i.width=300,i.height=24,i.size=40,i.textAlign="center",i.fontFamily="SimHei",i.x=t.width-i.width>>1,i.y=352,t.addChild(i);var o=new egret.RenderTexture;return o.drawToTexture(t),new egret.Bitmap(o)},e.prototype.feedBack=function(){var t=window.wx;null!=t&&t.openCustomerServiceConversation({success:function(t){console.log("success:",t)},fail:function(t){console.log("fail:",t)},complete:function(t){console.log("complete:",t)}})},e.prototype.showBanner=function(){if(console.log("系统信息：",wx.getSystemInfoSync()),null==this.bannerAd){var t=wx.getSystemInfoSync().screenWidth,e=wx.getSystemInfoSync().screenHeight;this.bannerAd=wx.createBannerAd({adUnitId:"adunit-465b0f38397b8e3f",style:{left:10,top:e-100,width:t-20}})}null!=this.bannerAd&&(this.bannerAd.onLoad(function(){console.log("banner 广告加载成功")}),this.bannerAd.show())},e.prototype.hideBanner=function(){null!=this.bannerAd&&this.bannerAd.hide()},e.prototype.initRewardVideoAd=function(){var t=this,e=window.wx;null!=e&&(this.rewardAd=e.createRewardedVideoAd({adUnitId:"adunit-dbf18bd3a9ac0892"}),this.rewardAd.onLoad(function(){console.log("激励视频 广告加载成功")}),this.rewardAd.onError(function(t){console.log("rewardAderror:",t)}),this.rewardAd.onClose(function(e){var n;n=e&&e.isEnded||void 0===e?0:1,t.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,n)}))},e.prototype.showRewardAd=function(t){var e=this;if(this.adtype=t,null!=this.rewardAd)try{this.rewardAd.show()["catch"](function(t){console.log("showRewardAd:",t),e.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)})}catch(n){this.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)}else this.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)},e.prototype.dispatchGameEvent=function(t,e){console.log("dispatchGameEvent:",t,this.adtype,e);
var n=new GameEvent(t);n.data={type:this.adtype,data:e},this.dispatchEvent(n)},e.prototype.skipToProgram=function(){try{wx.navigateToMiniProgram({appId:"wx5ccf73a5edb50795",extraData:"qiuqiu",success:function(t){console.log("navigateToMiniProgram:",t)},fail:function(t){console.log("navigateToMiniProgram:error:",t)},complete:function(){console.log("navigateToMiniProgram:complete:")}})}catch(t){wx.showToast({title:"该功能暂未开放",icon:"none",duration:2e3})}},e.prototype.postToDataContext=function(t){null!=wx&&wx.getOpenDataContext().postMessage(t)},e}(egret.EventDispatcher);__reflect(WxApi.prototype,"WxApi");var AchieveUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="AchieveSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),this.initView(),this.initEvent()},e.prototype.checkFit=function(){this.rect_bg.height=GameLogic.getInstance().GameStage.stageHeight,this.btn_back.y=this.rect_bg.height-this.btn_back.height},e.prototype.initView=function(){},e.prototype.initEvent=function(){this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.clickBack=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.clear=function(){this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e}(eui.Component);__reflect(AchieveUI.prototype,"AchieveUI");var GameUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),GameLogic.getInstance().gameui=this,this.market_arr=[],this.store_arr=[],this.eventlist=[],this.initView(),this.initEvent(),GameCommand.getInstance().startGame(),this.checkNewHand()},e.prototype.checkFit=function(){this.rect_bg.height=this.img_over_bg0.height=this.img_over_bg1.height=this.rect_evt.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.checkNewHand=function(){WxApi.getInstance().isNew()&&this.addChild(new NewGuild)},e.prototype.eventAppear=function(t){return GameLogic.getInstance().cbSelected?void 0:this.eventpoping?void this.eventlist.push(t):void this.popEvent(t)},e.prototype.eventNext=function(){this.eventpoping=!1;var t=this.cb_0.selected;if(t)this.eventlist=[],this.pop(0),GameLogic.getInstance().cbSelected=t;else if(this.eventlist.length>0){var e=this.eventlist.shift();this.popEvent(e)}else this.pop(0)},e.prototype.popEvent=function(t){this.eventpoping=!0,this.pop(11),this.lbl_event_1.text=t},e.prototype.initData=function(t){this.data=t,this.setLeft(),this.lbl_1.text=this.data.dwMoney.toString(),this.lbl_2.text=this.data.dwDeposit.toString(),this.lbl_3.text=this.data.dwDebt.toString(),this.lbl_4.text=this.data.dwPow.toString(),this.lbl_5.text=this.data.dwFame.toString();var e=GameLogic.getInstance().data.maxday;this.lbl_day.text=e-this.data.dwTimes+"/"+e+"天"},e.prototype.setLeft=function(){var t=this.getStoreNum();this.leftStore=this.data.dwMaxStoreNum-t,this.lbl_store.text=t+"/"+this.data.dwMaxStoreNum},e.prototype.getStoreNum=function(){for(var t=0,e=0;e<this.store_arr.length;e++){var n=this.store_arr[e];t+=n.good.dwNum}return t},e.prototype.initMarket=function(t){this.clearMarket();for(var e=[],n=0;n<t.goods.length;n++){var a=new MarketItem(t.goods[n]);a.y=(a.height+2)*n,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMarketItem,this),this.market_arr.push(a),this.gp_market.addChild(a);for(var i=0;i<this.store_arr.length;i++){var o=this.store_arr[i],r=o.good;if(null!=r&&r.dwID==a.good.dwID){a.same(!0),r.dwPrice<t.goods[n].dwPrice&&e.push(r.dwID);break}}}for(var i=0;i<this.store_arr.length;i++){var o=this.store_arr[i],s=-1!=e.indexOf(o.good.dwID);o.upState(s)}},e.prototype.clickMarketItem=function(t){var e=t.currentTarget;null!=this.crtMarketItem&&(this.crtMarketItem.select=!1),this.crtMarketItem=e,this.crtMarketItem.select=!0,this.pop(9);var n=Math.floor(this.data.dwMoney/e.good.dwPrice);this.max_num=n>this.leftStore?this.leftStore:n,this.lbl_buy_1.text=e.good.strName,this.lbl_num6.text=this.max_num+""},e.prototype.initStore=function(t){this.clearStore();for(var e=0;e<t.goods.length;e++){var n=new StoreItem(t.goods[e]);n.y=(n.height+2)*e,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStoreItem,this),this.store_arr.push(n),this.gp_store.addChild(n)}this.setLeft()},e.prototype.clickStoreItem=function(t){var e=t.currentTarget;null!=this.crtStoreItem&&(this.crtStoreItem.select=!1),this.crtStoreItem=e,this.crtStoreItem.select=!0,this.pop(10),this.max_num=this.crtStoreItem.good.dwNum,this.lbl_sell_1.text=e.good.strName,this.lbl_num7.text=this.max_num+""},e.prototype.storeUp=function(t){},e.prototype.over=function(){this.gp_over.visible=!0;var t="";if(this.data.dwPow<=0)t+=StringUtil.getSwfLangStr("s20")+"\n",this.btn_27.visible=!1;else{t+=StringUtil.getSwfLangStr("s11")+"\n",t+=StringUtil.getSwfLangStrVarByID("s21",[DataBase.money+""])+"\n",t+=StringUtil.getSwfLangStr("s12")+"\n";for(var e=0;5>e;e++)t+=StringUtil.getSwfLangStrVarByID("s1"+(3+e),[DataBase.achives[e]+""])+"\n";t+=StringUtil.getSwfLangStr("s19")+"\n",t+=StringUtil.getSwfLangStr("s50")+"\n",this.btn_27.visible=!0}this.lbl_over_1.text=t},e.prototype.errorRsp=function(t){this.eventAppear(StringUtil.getSwfLangStr("e"+t))},e.prototype.initView=function(){var t=SoundManager.getInstance().sound_switch;this.img_sound.source=RES.getRes(t?"game_json.noice1_zb":"game_json.noice2_zb")},e.prototype.initEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this);for(var t=0;28>=t;t++){var e=this["btn_"+t];e.name=t+"",e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this)}for(var t=0;7>=t;t++){var n=this["lbl_num"+t];n.name="lbl"+t,n.addEventListener(egret.Event.CHANGE,this.txtChange,this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.txtClick,this)}this.rect_evt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRect,this),this.img_sound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSound,this)},e.prototype.clickSound=function(){var t=!SoundManager.getInstance().sound_switch;SoundManager.getInstance().playBgSound(t),this.img_sound.source=RES.getRes(t?"game_json.noice1_zb":"game_json.noice2_zb")},e.prototype.cbChange=function(){},e.prototype.clickRect=function(t){this.eventNext()},e.prototype.txtClick=function(t){var e=t.currentTarget,n=parseInt(e.name.slice(3));switch(n){case 1:this.max_num=this.data.dwMoney;break;case 2:this.max_num=this.data.dwDeposit}},e.prototype.txtChange=function(t){var e=t.currentTarget,n=parseInt(e.text);n>this.max_num&&(e.text=this.max_num+"")},e.prototype.clickBtn=function(t){var e=parseInt(t.currentTarget.name);if(!(0==this.gamestate&&9>e&&e>12&&26>e))switch(e){case 0:this.pop(0),GameCommand.getInstance().charity(parseInt(this.lbl_num0.text));break;case 1:case 2:case 3:this.pop(0),GameCommand.getInstance().passOneDay();break;case 4:this.pop(e),this.max_num=this.data.dwMoney,this.lbl_charity.text=StringUtil.getSwfLangStr("s10"),this.lbl_num0.text="0";break;case 5:this.pop(e),this.lbl_num1.text=this.data.dwMoney+"",this.lbl_num2.text=this.data.dwDeposit+"";break;case 6:this.pop(e);var n=100-this.data.dwPow;0>=n?(this.lbl_hos_1.text=StringUtil.getSwfLangStr("s6"),this.max_num=0):(this.lbl_hos_1.text=StringUtil.getSwfLangStrVarByID("s7",[GameLogic.getInstance().data.hospital+""]),this.max_num=n),this.lbl_num3.text=this.max_num+"";break;case 7:this.pop(e);var a=GameLogic.getInstance().data.maxstore-this.data.dwMaxStoreNum;if(0>=a)this.lbl_medi_1.text=StringUtil.getSwfLangStr("s8");else{var i=GameLogic.getInstance().data.storeprice,o=Math.floor(Math.random()*i/5)+i;this.lbl_medi_1.text=StringUtil.getSwfLangStrVarByID("s9",[o+""])}break;case 8:this.pop(e);var r=this.data.dwDebt,s=this.data.dwMoney>r?r:this.data.dwMoney;0>=r?(this.lbl_post_1.text=StringUtil.getSwfLangStr("s102"),this.max_num=0):(this.lbl_post_1.text=StringUtil.getSwfLangStr("s101"),this.max_num=s),this.lbl_num5.text=this.max_num+"";break;case 9:WxApi.getInstance().share();break;case 10:this.addChild(new NewGuild);break;case 11:GameLogic.getInstance().openRank();break;case 12:case 26:this.restart();break;case 13:GameCommand.getInstance().cun(parseInt(this.lbl_num1.text)),this.pop(0);break;case 14:GameCommand.getInstance().qu(parseInt(this.lbl_num2.text)),this.pop(0);break;case 15:this.data.dwPow<100&&GameCommand.getInstance().treat(100-this.data.dwPow),this.pop(0);break;case 17:var h=GameLogic.getInstance().data.storeprice;h=Math.floor(Math.random()*h/5)+h,GameCommand.getInstance().buyStore(h),this.pop(0);break;case 19:var c=parseInt(this.lbl_num5.text);c=this.data.dwMoney<c?this.data.dwMoney:c,GameCommand.getInstance().huan(c),this.pop(0);break;case 21:var l=parseInt(this.lbl_num6.text);l>0&&GameCommand.getInstance().buyGoods(this.crtMarketItem.good.dwID,l),this.pop(0);break;case 23:var u=parseInt(this.lbl_num7.text);u>0&&GameCommand.getInstance().sellGoods(this.crtStoreItem.good.dwID,u),this.pop(0);break;case 16:case 18:case 20:case 22:case 24:this.pop(0);break;case 25:this.eventNext();break;case 27:WxApi.getInstance().share();break;case 28:WxApi.getInstance().toast("暂未开放，尽请期待")}},e.prototype.pop=function(t){if(null!=this.crtPop){var e=this["gp_"+this.crtPop];null!=e&&(e.visible=!1)}0==t&&(this.eventpoping=!1);var n=this["gp_"+t];null!=n?(n.visible=!0,this.crtPop=t):this.crtPop=null},e.prototype.clearMarket=function(){for(var t=0;t<this.market_arr.length;t++){this.market_arr[t]}this.gp_market.removeChildren(),this.market_arr=[],this.crtMarketItem=null},e.prototype.clearStore=function(){for(var t=0;t<this.store_arr.length;t++){var e=this.store_arr[t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStoreItem,this)}this.gp_store.removeChildren(),this.store_arr=[],this.crtStoreItem=null},e.prototype.restart=function(){GameLogic.getInstance().openStart()},e.prototype.clear=function(){this.clearEvent(),this.clearMarket(),this.clearStore(),GameLogic.getInstance().gameui=null},e.prototype.clearEvent=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this);for(var t=0;28>=t;t++){var e=this["btn_"+t];e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this)}for(var t=0;7>=t;t++){var n=this["lbl_num"+t];n.removeEventListener(egret.Event.CHANGE,this.txtChange,this),n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.txtClick,this)}this.rect_evt.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRect,this),this.img_sound.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSound,this)},e}(eui.Component);__reflect(GameUI.prototype,"GameUI");var MarketItem=function(t){function e(e){var n=t.call(this)||this;return n.good=e,n.skinName="MarketItemSkin",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.lbl_name.text=this.good.strName,this.lbl_price.text=this.good.dwPrice+""},e.prototype.same=function(t){this.rect_same.visible=t},Object.defineProperty(e.prototype,"select",{get:function(){return this._select},set:function(t){this._select=t,this.rect_bg.visible=t},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.good=null},e}(eui.Component);__reflect(MarketItem.prototype,"MarketItem");var NewGuild=function(t){function e(){var e=t.call(this)||this;return e.skinName="NewGuildSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.guidestep=0,this.nextGuide(),this.checkFit(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.checkFit=function(){this.rect_bg.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.clickBtn=function(t){t.target==this.btn_over?this.over():this.nextGuide()},e.prototype.over=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.nextGuide=function(){null!=this.crtstep&&(this.crtstep.visible=!1);var t=this["gp_"+this.guidestep];return null==t?void this.over():(this["lbl_"+this.guidestep].text=StringUtil.getSwfLangStr("guidestr"+this.guidestep),this.crtstep=t,this.crtstep.visible=!0,void this.guidestep++)},e.prototype.clear=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e}(eui.Component);__reflect(NewGuild.prototype,"NewGuild");var RankUI=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.shareticket=e,n.skinName="RankSkin",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),this.initView(),this.initEvent()},e.prototype.checkFit=function(){var t=GameLogic.getInstance().GameStage.stageHeight;this.height=this.rect_bg.height=t},e.prototype.initView=function(){this.lbl_title.text=null!=this.shareticket?"群排行榜":"好友排行榜",this.initDataContext()},e.prototype.initDataContext=function(){var t=window.platform;null!=t.openDataContext&&(this.bmp_context=t.openDataContext.createDisplayObject(null,this.stage.stageWidth,this.stage.stageHeight),this.addChildAt(this.bmp_context,4),WxApi.getInstance().postToDataContext({shareTicket:this.shareticket,stageW:GameLogic.getInstance().GameStage.stageWidth,stageH:GameLogic.getInstance().GameStage.stageHeight,command:"open"}))},e.prototype.initEvent=function(){this.img_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this),this.btn_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGroupRank,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.clickGroupRank=function(){WxApi.getInstance().share("grouprank=1")},e.prototype.clickClose=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.clear=function(){this.img_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this),this.btn_group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGroupRank,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),WxApi.getInstance().postToDataContext({command:"close"}),null!=this.bmp_context&&null!=this.bmp_context.parent&&(this.bmp_context.parent.removeChild(this.bmp_context),this.bmp_context=null)},e}(eui.Component);__reflect(RankUI.prototype,"RankUI"),window.RankUI=RankUI;var StartUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="StartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit();var e=GameLogic.getInstance().data;this.lbl_content.text=StringUtil.getSwfLangStr("s2"),this.updateProp();for(var n=1;3>=n;n++){var a=e["config"+n],i="开始游戏";i=1==n?i:"使用券"+i,i+="\n"+a.pow+"体力 "+a.debt+"欠债 "+a.money+"启动资金\n",2==n&&(i+="(可获炒房证)");var o=this["btn_"+n];o.label=i,o.name=n+"",o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this)}this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),GameLogic.getInstance().addEventListener(GameEvent.PROP_NUM_CHANGE,this.updateProp,this),WxApi.getInstance().checkWx()&&(this.button=wx.createGameClubButton({icon:"white",style:{left:10,top:40,width:32,height:32,text:"游戏圈"}}))},e.prototype.checkFit=function(){this.img_bg.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.updateProp=function(){this.lbl_prop.text="分享可获得炒房券（炒房券 X"+PlayerConst.prop_num+"）"},e.prototype.clickBtn=function(t){if(null==GameLogic.getInstance().strings)return void(this.lbl_log.text="正在形成市场，请稍后...");var e=parseInt(t.currentTarget.name);return 2==e&&PlayerConst.prop_num<=0?void WxApi.getInstance().showToast("邀请好友进入游戏可获得炒房券"):(GameCommand.getInstance().selectPackage(e),void GameLogic.getInstance().startGame())},e.prototype.clear=function(){for(var t=1;3>=t;t++)this["btn_"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this);this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),GameLogic.getInstance().removeEventListener(GameEvent.PROP_NUM_CHANGE,this.updateProp,this),null!=this.button&&this.button.destroy()},e}(eui.Component);__reflect(StartUI.prototype,"StartUI");var StoreItem=function(t){function e(e){var n=t.call(this)||this;return n.good=e,n.skinName="StoreItemSkin",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.update()},e.prototype.upState=function(t){this.img_up.visible=t},e.prototype.updateGood=function(t){this.good=t,this.update()},e.prototype.update=function(){this.lbl_name.text=this.good.strName,this.lbl_price.text=this.good.dwPrice+"",this.lbl_num.text=this.good.dwNum+""},Object.defineProperty(e.prototype,"select",{get:function(){return this._select},set:function(t){this._select=t,this.rect_bg.visible=t},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.good=null},e}(eui.Component);__reflect(StoreItem.prototype,"StoreItem"),window.Main=Main;